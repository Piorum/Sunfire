using System.Collections.ObjectModel;
using System.Runtime.CompilerServices;
using Sunfire.Glyph;
using Sunfire.Ansi.Models;
using Sunfire.FSUtils.Models;

namespace Sunfire.Registries;

public static class IconRegistry
{
    //Icons from extension
    public static readonly ReadOnlyDictionary<string, (string icon, SColor? color)> Icons = new(new Dictionary<string, (string, SColor?)>()
    {
        { ".styl", ("", new(141,193,73)) },
        { ".sass", ("", new(245,83,133)) },
        { ".scss", ("", new(245,83,133)) },
        { ".htm", ("", new(227,76,38)) },
        { ".html", ("", new(227,76,38)) },
        { ".slim", ("", new(227,76,38)) },
        { ".haml", ("", new(234,234,225)) },
        { ".ejs", ("", new(203,203,65)) },
        { ".css", ("", new(86,61,124)) },
        { ".less", ("", new(86,61,124)) },
        { ".md", ("", new(81,154,186)) },
        { ".mdx", ("", new(81,154,186)) },
        { ".markdown", ("", new(81,154,186)) },
        { ".rmd", ("", new(81,154,186)) },
        { ".json", ("", new(149,157,165)) },
        { ".webmanifest", ("", new(241,224,90)) },
        { ".js", ("", new(203,203,65)) },
        { ".mjs", ("", new(241,224,90)) },
        { ".jsx", ("", new(81,154,186)) },
        { ".rb", ("", new(112,21,22)) },
        { ".gemspec", ("", new(112,21,22)) },
        { ".rake", ("", new(112,21,22)) },
        { ".php", ("", new(160,116,196)) },
        { ".py", ("", new(81,154,186)) },
        { ".pyc", ("", new(81,154,186)) },
        { ".pyo", ("", new(81,154,186)) },
        { ".pyd", ("", new(81,154,186)) },
        { ".coffee", ("", new(203,203,65)) },
        { ".mustache", ("", new(227,121,51)) },
        { ".hbs", ("", new(240,119,43)) },
        { ".conf", ("", new(109,128,134)) },
        { ".ini", ("", new(109,128,134)) },
        { ".yml", ("", new(149,157,165)) },
        { ".yaml", ("", new(149,157,165)) },
        { ".toml", ("", new(109,128,134)) },
        { ".bat", ("", new(193,241,46)) },
        { ".mk", ("", new(109,128,134)) },
        { ".ico", ("", new(203,203,65)) },
        { ".twig", ("", new(141,193,73)) },
        { ".cpp", ("", new(81,154,186)) },
        { ".c++", ("", new(89,158,255)) },
        { ".cxx", ("", new(81,154,186)) },
        { ".cc", ("", new(81,154,186)) },
        { ".cp", ("", new(81,154,186)) },
        { ".c", ("", new(89,158,255)) },
        { ".cs", ("\udb80\udf1b", new(89,103,6)) },
        { ".h", ("", new(160,116,196)) },
        { ".hh", ("", new(160,116,196)) },
        { ".hpp", ("", new(160,116,196)) },
        { ".hxx", ("", new(160,116,196)) },
        { ".hs", ("", new(160,116,196)) },
        { ".lhs", ("", new(160,116,196)) },
        { ".nix", ("", new(126,186,228)) },
        { ".lua", ("", new(81,160,207)) },
        { ".java", ("", new(204,62,68)) },
        { ".sh", ("", new(137,224,81)) },
        { ".fish", ("", new(137,224,81)) },
        { ".bash", ("", new(137,224,81)) },
        { ".zsh", ("", new(137,224,81)) },
        { ".ksh", ("", new(137,224,81)) },
        { ".csh", ("", new(137,224,81)) },
        { ".awk", ("", new(137,224,81)) },
        { ".ps1", ("", new(137,224,81)) },
        { ".ml", ("λ", new(227,121,51)) },
        { ".mli", ("λ", new(227,121,51)) },
        { ".diff", ("", new(65,83,91)) },
        { ".db", ("", new(218,216,216)) },
        { ".sql", ("", new(218,216,216)) },
        { ".dump", ("", new(218,216,216)) },
        { ".clj", ("", new(141,193,73)) },
        { ".cljc", ("", new(141,193,73)) },
        { ".cljs", ("", new(81,154,186)) },
        { ".edn", ("", new(81,154,186)) },
        { ".scala", ("", new(204,62,68)) },
        { ".go", ("", new(81,154,186)) },
        { ".dart", ("", new(3,88,156)) },
        { ".xul", ("", new(227,121,51)) },
        { ".sln", ("", new(133,76,199)) },
        { ".suo", ("", new(133,76,199)) },
        { ".pl", ("", new(81,154,186)) },
        { ".pm", ("", new(81,154,186)) },
        { ".t", ("", new(81,154,186)) },
        { ".rss", ("", new(251,157,59)) },
        { ".fsscript", ("", new(81,154,186)) },
        { ".fsx", ("", new(81,154,186)) },
        { ".fs", ("", new(81,154,186)) },
        { ".fsi", ("", new(81,154,186)) },
        { ".rs", ("", new(222,165,132)) },
        { ".rlib", ("", new(222,165,132)) },
        { ".d", ("", new(66,120,25)) },
        { ".erl", ("", new(184,57,152)) },
        { ".hrl", ("", new(184,57,152)) },
        { ".ex", ("", new(160,116,196)) },
        { ".exs", ("", new(160,116,196)) },
        { ".eex", ("", new(160,116,196)) },
        { ".leex", ("", new(160,116,196)) },
        { ".heex", ("", new(160,116,196)) },
        { ".vim", ("", new(1,152,51)) },
        { ".ai", ("", new(203,203,65)) },
        { ".psd", ("", new(81,154,186)) },
        { ".psb", ("", new(81,154,186)) },
        { ".ts", ("", new(81,154,186)) },
        { ".tsx", ("", new(81,154,186)) },
        { ".jl", ("", new(162,112,186)) },
        { ".pp", ("", new(255,166,26)) },
        { ".vue", ("", new(141,193,73)) },
        { ".elm", ("", new(81,154,186)) },
        { ".swift", ("", new(227,121,51)) },
        { ".xcplayground", ("", new(227,121,51)) },
        { ".tex", ("󰙩", new(61,97,23)) },
        { ".r", ("󰟔", new(53,138,91)) },
        { ".rproj", ("󰗆", new(53,138,91)) },
        { ".sol", ("󰡪", new(81,154,186)) },
        { ".pem", ("", new(205,155,62)) },
        { ".ds_store", ("", new(77,90,94)) },
        { ".gitconfig", ("", new(65,83,91)) },
        { ".gitignore", ("", new(65,83,91)) },
        { ".gitattributes", ("", new(65,83,91)) },
        { ".gitlab-ci.yml", ("", new(226,67,41)) },
        { ".bashrc", ("", new(137,224,81)) },
        { ".zshrc", ("", new(137,224,81)) },
        { ".zshenv", ("", new(137,224,81)) },
        { ".zprofile", ("", new(137,224,81)) },
        { ".vimrc", ("", new(1,152,51)) },
        { ".gvimrc", ("", new(1,152,51)) },
        { ".bashprofile", ("", new(137,224,81)) },
        { ".DS_Store", ("", new(193,241,46)) },
        { ".tar", (" ", null) },
        { ".tgz", (" ", null) },
        { ".arc", (" ", null) },
        { ".arj", (" ", null) },
        { ".taz", (" ", null) },
        { ".lha", (" ", null) },
        { ".lz4", (" ", null) },
        { ".lzh", (" ", null) },
        { ".lzma", (" ", null) },
        { ".tlz", (" ", null) },
        { ".txz", (" ", null) },
        { ".tzo", (" ", null) },
        { ".t7z", (" ", null) },
        { ".zip", (" ", null) },
        { ".z", (" ", null) },
        { ".dz", (" ", null) },
        { ".gz", (" ", null) },
        { ".lrz", (" ", null) },
        { ".lz", (" ", null) },
        { ".lzo", (" ", null) },
        { ".xz", (" ", null) },
        { ".zst", (" ", null) },
        { ".tzst", (" ", null) },
        { ".bz2", (" ", null) },
        { ".bz", (" ", null) },
        { ".tbz", (" ", null) },
        { ".tbz2", (" ", null) },
        { ".tz", (" ", null) },
        { ".deb", (" ", null) },
        { ".rpm", (" ", null) },
        { ".jar", (" ", null) },
        { ".war", (" ", null) },
        { ".ear", (" ", null) },
        { ".sar", (" ", null) },
        { ".rar", (" ", null) },
        { ".alz", (" ", null) },
        { ".ace", (" ", null) },
        { ".zoo", (" ", null) },
        { ".cpio", (" ", null) },
        { ".7z", (" ", null) },
        { ".rz", (" ", null) },
        { ".cab", (" ", null) },
        { ".wim", (" ", null) },
        { ".swm", (" ", null) },
        { ".dwm", (" ", null) },
        { ".esd", (" ", null) },
        { ".jpg", ("", new(160,116,196)) },
        { ".jpeg", ("", new(160,116,196)) },
        { ".bmp", ("", new(160,116,196)) },
        { ".png", ("", new(160,116,196)) },
        { ".webp", ("", new(160,116,196)) },
        { ".gif", ("", new(160,116,196)) },
        { ".mjpg", ("", new(160,116,196)) },
        { ".mjpeg", ("", new(160,116,196)) },
        { ".pbm", ("", new(160,116,196)) },
        { ".pgm", ("", new(160,116,196)) },
        { ".ppm", ("", new(160,116,196)) },
        { ".tga", ("", new(160,116,196)) },
        { ".xbm", ("", new(160,116,196)) },
        { ".xpm", ("", new(160,116,196)) },
        { ".tif", ("", new(160,116,196)) },
        { ".tiff", ("", new(160,116,196)) },
        { ".svg", ("", new(160,116,196)) },
        { ".svgz", ("", new(160,116,196)) },
        { ".mng", ("", new(160,116,196)) },
        { ".pcx", ("", new(160,116,196)) },
        { ".mov", ("", new(160,116,196)) },
        { ".mpg", ("", new(160,116,196)) },
        { ".mpeg", ("", new(160,116,196)) },
        { ".m2v", ("", new(160,116,196)) },
        { ".mkv", ("", new(160,116,196)) },
        { ".webm", ("", new(160,116,196)) },
        { ".ogm", ("", new(160,116,196)) },
        { ".mp4", ("", new(160,116,196)) },
        { ".m4v", ("", new(160,116,196)) },
        { ".mp4v", ("", new(160,116,196)) },
        { ".vob", ("", new(160,116,196)) },
        { ".qt", ("", new(160,116,196)) },
        { ".nuv", ("", new(160,116,196)) },
        { ".wmv", ("", new(160,116,196)) },
        { ".asf", ("", new(160,116,196)) },
        { ".rm", ("", new(160,116,196)) },
        { ".rmvb", ("", new(160,116,196)) },
        { ".flc", ("", new(160,116,196)) },
        { ".avi", ("", new(160,116,196)) },
        { ".fli", ("", new(160,116,196)) },
        { ".flv", ("", new(160,116,196)) },
        { ".gl", ("", new(160,116,196)) },
        { ".dl", ("", new(160,116,196)) },
        { ".xcf", ("", new(160,116,196)) },
        { ".xwd", ("", new(160,116,196)) },
        { ".yuv", ("", new(160,116,196)) },
        { ".cgm", ("", new(160,116,196)) },
        { ".emf", ("", new(160,116,196)) },
        { ".ogv", ("", new(160,116,196)) },
        { ".ogx", ("", new(160,116,196)) },
        { ".aac", ("", new(160,116,196)) },
        { ".au", ("", new(160,116,196)) },
        { ".flac", ("", new(160,116,196)) },
        { ".m4a", ("", new(160,116,196)) },
        { ".mid", ("", new(160,116,196)) },
        { ".midi", ("", new(160,116,196)) },
        { ".mka", ("", new(160,116,196)) },
        { ".mp3", ("", new(160,116,196)) },
        { ".mpc", ("", new(160,116,196)) },
        { ".ogg", ("", new(160,116,196)) },
        { ".ra", ("", new(160,116,196)) },
        { ".wav", ("", new(160,116,196)) },
        { ".oga", ("", new(160,116,196)) },
        { ".opus", ("", new(160,116,196)) },
        { ".spx", ("", new(160,116,196)) },
        { ".xspf", ("", new(160,116,196)) },
        { ".pdf", ("", new(179,11,0)) },
    });

    //Icons from full file name (Favored over extension based icon)
    public static readonly ReadOnlyDictionary<string, (string icon, SColor? color)> SpecialIcons = new(new Dictionary<string, (string, SColor?)>()
    {
        { "gruntfile.coffee", ("", new(227,121,51)) },
        { "gruntfile.js", ("", new(227,121,51)) },
        { "gruntfile.ls", ("", new(227,121,51)) },
        { "gulpfile.coffee", ("", new(204,62,68)) },
        { "gulpfile.js", ("", new(204,62,68)) },
        { "gulpfile.ls", ("", new(204,62,68)) },
        { "mix.lock", ("", new(160,116,196)) },
        { "dropbox", ("", new(0,97,254)) },
        { "_vimrc", ("", new(1,152,51)) },
        { "_gvimrc", ("", new(1,152,51)) },
        { "favicon.ico", ("", new(203,203,65)) },
        { "license", ("", new(203,203,65)) },
        { "node_modules", ("", new(232,39,75)) },
        { "react.jsx", ("", new(81,154,186)) },
        { "procfile", ("", new(160,116,196)) },
        { "dockerfile", ("", new(81,154,186)) },
        { "docker-compose.yml", ("", new(81,154,186)) },
        { "docker-compose.yaml", ("", new(81,154,186)) },
        { "compose.yml", ("", new(81,154,186)) },
        { "compose.yaml", ("", new(81,154,186)) },
        { "rakefile", ("", new(112,21,22)) },
        { "config.ru", ("", new(112,21,22)) },
        { "gemfile", ("", new(112,21,22)) },
        { "makefile", ("", new(109,128,134)) },
        { "cmakelists.txt", ("", new(109,128,134)) },
        { "robots.txt", ("󰚩", new(109,128,134)) },
        { "Gruntfile.coffee", ("", new(227,121,51)) },
        { "Gruntfile.js", ("", new(227,121,51)) },
        { "Gruntfile.ls", ("", new(227,121,51)) },
        { "Gulpfile.coffee", ("", new(204,62,68)) },
        { "Gulpfile.js", ("", new(204,62,68)) },
        { "Gulpfile.ls", ("", new(204,62,68)) },
        { "Dropbox", ("", new(0,97,254)) },
        { "LICENSE", ("", new(203,203,65)) },
        { "React.jsx", ("", new(81,154,186)) },
        { "Procfile", ("", new(160,116,196)) },
        { "Dockerfile", ("", new(81,154,186)) },
        { "Docker-compose.yml", ("", new(81,154,186)) },
        { "Docker-compose.yaml", ("", new(81,154,186)) },
        { "Rakefile", ("", new(112,21,22)) },
        { "Gemfile", ("", new(112,21,22)) },
        { "Makefile", ("", new(109,128,134)) },
        { "CMakeLists.txt", ("", new(109,128,134)) },
        { "jquery.min.js", ("", new(227,117,187)) },
        { "angular.min.js", ("", new(226,50,55)) },
        { "backbone.min.js", ("", new(0,113,181)) },
        { "require.min.js", ("", new(244,74,65)) },
        { "materialize.min.js", ("", new(238,110,115)) },
        { "materialize.min.css", ("", new(238,110,115)) },
        { "mootools.min.js", ("", new(236,236,236)) },
        { "vimrc", ("", new(1,152,51)) },
    });

    public static readonly string DirectoryIcon = "";

    public static readonly string FallbackFileIcon = "";


    [ModuleInitializer]
    public static void Init()
    {
        foreach(var icon in Icons.Values)
            GlyphLibrary.AddOrUpdate(icon.icon, 2);
        foreach(var icon in SpecialIcons.Values)
            GlyphLibrary.AddOrUpdate(icon.icon, 2);
        
        GlyphLibrary.AddOrUpdate(DirectoryIcon, 2);
        GlyphLibrary.AddOrUpdate(FallbackFileIcon, 2);
    }

    public static (string icon, SColor? color) GetIcon(FSEntry entry) =>
        entry.IsDirectory
            ? (DirectoryIcon, ColorRegistry.DirectoryColor)
            : SpecialIcons.TryGetValue(entry.Name, out var special) 
                ? special 
                : Icons.TryGetValue(entry.Extension, out var normal)
                    ? normal
                    : (FallbackFileIcon, ColorRegistry.FileColor);

}